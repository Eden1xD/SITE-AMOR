<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Convite de Namoro Neon ðŸ’–</title>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
<style>
body { font-family: 'Arial', sans-serif; margin:0; padding:0; display:flex; flex-direction:column; align-items:center; min-height:100vh; background:#111; color:#fff; overflow-x:hidden; }
h1 { font-family: 'Pacifico', cursive; font-size:3rem; color:#ff6fff; text-shadow:0 0 5px #ff6fff,0 0 10px #ff6fff,0 0 20px #ff6fff; margin:20px 0; }
.container { display:flex; flex-wrap:wrap; justify-content:center; gap:20px; width:90%; max-width:1200px; }
.box { background: rgba(20,20,20,0.8); border: 2px solid #ff6fff; border-radius:15px; padding:20px; flex:1 1 300px; min-width:280px; box-shadow:0 0 20px #ff6fff; transition:0.3s; }
.box:hover { box-shadow:0 0 40px #ff6fff; }
label { margin-top:10px; display:block; font-weight:bold; }
input,textarea,select { width:100%; padding:8px; margin-top:5px; border-radius:8px; border:1px solid #ff6fff; background:#111; color:#fff; font-size:16px; }
input:focus,textarea:focus{ outline:none; border-color:#ff3fff; box-shadow:0 0 10px #ff3fff; }
button { margin-top:15px; padding:12px 20px; border:none; border-radius:10px; background:#ff6fff; color:#fff; font-size:18px; cursor:pointer; transition:0.3s; box-shadow: 0 0 5px #ff6fff, 0 0 10px #ff6fff, 0 0 20px #ff6fff; }
button:hover { box-shadow:0 0 15px #ff3fff,0 0 30px #ff3fff,0 0 60px #ff3fff; }
#preview { position:relative; width:100%; min-height:500px; border-radius:15px; overflow:hidden; text-align:center; background:#111; display:flex; flex-direction:column; align-items:center; justify-content:center; padding:15px; box-shadow: 0 0 20px #ff6fff inset; }
#imgMain { width:150px; height:150px; border-radius:50%; object-fit:cover; margin:10px 0; border:5px solid #ff6fff; box-shadow:0 0 20px #ff6fff,0 0 40px #ff3fff,0 0 60px #ff6fff; animation: glow 2s infinite alternate; }
@keyframes glow{ 0%{ box-shadow:0 0 20px #ff6fff,0 0 40px #ff3fff,0 0 60px #ff6fff; } 50%{ box-shadow:0 0 40px #ff6fff,0 0 60px #ff3fff,0 0 80px #ff6fff; } 100%{ box-shadow:0 0 20px #ff6fff,0 0 40px #ff3fff,0 0 60px #ff6fff; } }
#previewMensagem { font-size:20px; margin:10px 0; text-shadow:0 0 5px #ff6fff,0 0 10px #ff3fff; }
#countdown { display:flex; gap:10px; margin-top:10px; flex-wrap:wrap; justify-content:center; }
.count-box { background:#111; border:2px solid #ff6fff; padding:10px 15px; border-radius:10px; box-shadow:0 0 10px #ff6fff,0 0 20px #ff3fff; font-weight:bold; font-size:18px; min-width:60px; }
#galeria { display:flex; justify-content:center; gap:10px; margin-top:10px; flex-wrap:wrap; }
#galeria img { width:80px; height:80px; object-fit:cover; border-radius:10px; border:2px solid #ff6fff; cursor:pointer; transition:transform 0.3s; }
#galeria img:hover { transform: scale(1.2); border-color:#ff3fff; }
audio{ margin-top:15px; width:100%; outline:none; }
</style>
</head>
<body>

<h1>Convite Neon ðŸ’–</h1>
<div class="container">
<div class="box">
<h2>ConfiguraÃ§Ã£o do Convite</h2>
<label>Nome do casal:</label>
<input type="text" id="nomes" placeholder="Ex: JoÃ£o & Maria">
<label>Mensagem:</label>
<textarea id="mensagem" rows="4" placeholder="Mensagem de amor..."></textarea>
<label>Data do namoro:</label>
<input type="datetime-local" id="data_namoro">
<label>Link da mÃºsica (MP3/URL):</label>
<input type="text" id="musica" placeholder="https://link-da-musica.mp3">
<label>Cor de fundo:</label>
<input type="color" id="cor_fundo" value="#111111">
<label>Imagem principal:</label>
<input type="file" id="imgPrincipal" accept="image/*">
<label>Galeria (atÃ© 3 imagens):</label>
<input type="file" id="galeriaInput" accept="image/*" multiple>
<button id="previewBtn">Atualizar Preview</button>
<button id="gerarQr">Criar & Baixar QR Code</button>
</div>

<div class="box">
<h2>Preview</h2>
<div id="preview">
<h2 id="previewNomes">Seu Nome & Parceiro(a)</h2>
<p id="previewMensagem">Mensagem de amor...</p>
<img id="imgMain" src="" style="display:none;">
<div id="galeria"></div>
<div id="countdown">
<div class="count-box" id="dias">00d</div>
<div class="count-box" id="horas">00h</div>
<div class="count-box" id="minutos">00m</div>
<div class="count-box" id="segundos">00s</div>
</div>
<audio id="audioPreview" controls></audio>
</div>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
<script>
const previewNomes = document.getElementById('previewNomes');
const previewMensagem = document.getElementById('previewMensagem');
const countdownEl = document.getElementById('countdown');
const previewDiv = document.getElementById('preview');
const audioPreview = document.getElementById('audioPreview');
const imgMain = document.getElementById('imgMain');
const galeriaDiv = document.getElementById('galeria');
let galeriaImgs = [];

document.getElementById('galeriaInput').addEventListener('change', (e) => {
    galeriaImgs = [];
    galeriaDiv.innerHTML = '';
    const files = Array.from(e.target.files).slice(0,3);
    files.forEach(file => {
        const reader = new FileReader();
        reader.onload = function(ev){
            galeriaImgs.push(ev.target.result);
            const img = document.createElement('img');
            img.src = ev.target.result;
            galeriaDiv.appendChild(img);
        }
        reader.readAsDataURL(file);
    });
});

document.getElementById('imgPrincipal').addEventListener('change', (e) => {
    const file = e.target.files[0];
    if(!file) return;
    const reader = new FileReader();
    reader.onload = function(ev){
        imgMain.src = ev.target.result;
        imgMain.style.display='block';
    }
    reader.readAsDataURL(file);
});

document.getElementById('previewBtn').addEventListener('click', () => {
    const nomes = document.getElementById('nomes').value || 'Seu Nome & Parceiro(a)';
    const mensagem = document.getElementById('mensagem').value || 'Mensagem de amor...';
    const dataNamoro = document.getElementById('data_namoro').value;
    const musica = document.getElementById('musica').value;
    const corFundo = document.getElementById('cor_fundo').value;
    previewNomes.textContent = nomes;
    previewMensagem.textContent = mensagem;
    previewDiv.style.background = corFundo;
    if(musica) audioPreview.src = musica;
    if(dataNamoro){
        clearInterval(window.countdownInterval);
        updateCountdown(new Date(dataNamoro));
        window.countdownInterval = setInterval(()=>updateCountdown(new Date(dataNamoro)),1000);
    }
});

function updateCountdown(date){
    const now = new Date();
    let diff = Math.abs(date-now)/1000;
    const dias=Math.floor(diff/86400);
    diff-=dias*86400;
    const horas=Math.floor(diff/3600)%24;
    const minutos=Math.floor(diff/60)%60;
    const segundos=Math.floor(diff%60);
    document.getElementById('dias').textContent=`${dias}d`;
    document.getElementById('horas').textContent=`${horas}h`;
    document.getElementById('minutos').textContent=`${minutos}m`;
    document.getElementById('segundos').textContent=`${segundos}s`;
}

document.getElementById('gerarQr').addEventListener('click', ()=>{
    const data={
        nomes: document.getElementById('nomes').value,
        mensagem: document.getElementById('mensagem').value,
        data_namoro: document.getElementById('data_namoro').value,
        musica: document.getElementById('musica').value,
        cor_fundo: document.getElementById('cor_fundo').value,
        imgPrincipal: imgMain.src||'',
        galeria: galeriaImgs
    };
    const jsonData = encodeURIComponent(JSON.stringify(data));
    const conviteURL = `${window.location.origin}/convite.html?data=${jsonData}`;
    
    // Abrir convite final em nova aba
    window.open(conviteURL,'_blank');

    // Gerar e baixar QR Code automaticamente
    QRCode.toDataURL(conviteURL, {width:300}, function(err,url){
        if(err) return console.error(err);
        const a=document.createElement('a');
        a.href = url;
        a.download = 'convite_qrcode.png';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    });
});

document.getElementById('gerarQr').addEventListener('click', ()=>{
    const data={
        nomes: document.getElementById('nomes').value,
        mensagem: document.getElementById('mensagem').value,
        data_namoro: document.getElementById('data_namoro').value,
        musica: document.getElementById('musica').value,
        cor_fundo: document.getElementById('cor_fundo').value,
        imgPrincipal: imgMain.src||'',
        galeria: galeriaImgs
    };
    const jsonData = encodeURIComponent(JSON.stringify(data));
    const conviteURL = `${window.location.origin}/convite.html?data=${jsonData}`;
    
    // Abrir convite final em nova aba automaticamente
    window.open(conviteURL,'_blank');

    // Gerar e baixar QR Code automaticamente
    QRCode.toDataURL(conviteURL, {width:300}, function(err,url){
        if(err) return console.error(err);
        const a=document.createElement('a');
        a.href = url;
        a.download = 'convite_qrcode.png';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    });
});
</script>